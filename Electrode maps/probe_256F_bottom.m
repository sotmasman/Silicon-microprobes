%first column = channel number on probe.  Convention is ch. 1 is at top left of PCB
%and number wrap around in counter-clockwise fashion.

%second column = x coordinate, horizontal distance to reference electrode in microns.  Convention is
%for reference electrode to be at bottom left corner of array when array
%points up.

%third column = y coordinate.  Convention is for this coordinate to be zero
%unless the probe is 3D.

%forth column = z coordinate, vertical distance to reference electrode in microns.  Convention is
%for reference electrode to be at bottom left corner of array when array
%points up.

%fifth column = shaft number.  Convention is for shaft 1 to be the
%right-most shaft when array points up.

probewiring=[

           1          20           0          25           2
           2          20           0         125           2
           3          20           0         225           2
           4          20           0         325           2
           5          20           0         425           2
           6          20           0         525           2
           7          20           0         625           2
           8          20           0         725           2
           9          20           0         825           2
          10          20           0         925           2
          11          20           0        1025           2
          12          20           0        1125           2
          13          20           0        1225           2
          14          20           0        1325           2
          15          20           0        1425           2
          16          20           0        1525           2
          17           0           0           0           2
          18           0           0          50           2
          19           0           0         100           2
          20           0           0         150           2
          21           0           0         200           2
          22           0           0         250           2
          23           0           0         300           2
          24           0           0         350           2
          25           0           0         400           2
          26           0           0         450           2
          27           0           0         500           2
          28           0           0         550           2
          29           0           0         600           2
          30           0           0         650           2
          31           0           0         700           2
          32           0           0         750           2
          33           0           0         800           2
          34           0           0         850           2
          35           0           0         900           2
          36           0           0         950           2
          37           0           0        1000           2
          38           0           0        1050           2
          39           0           0        1100           2
          40           0           0        1150           2
          41           0           0        1200           2
          42           0           0        1250           2
          43           0           0        1300           2
          44           0           0        1350           2
          45           0           0        1400           2
          46           0           0        1450           2
          47           0           0        1500           2
          48           0           0        1550           2
          49           0           0        1600           2
          50           0           0        1650           2
          51          20           0        1725           2
          52           0           0        1700           2
          53           0           0        1750           2
          54          20           0        1825           2
          55           0           0        1800           2
          56           0           0        1850           2
          57          20           0        1925           2
          58           0           0        1900           2
          59           0           0        1950           2
          60          20           0        2025           2
          61           0           0        2000           2
          62          20           0        2100           2
          63          20           0        2125           2
          64           4           0        2050           2
          65          20           0          75           2
          66          20           0         175           2
          67          20           0         275           2
          68          20           0         375           2
          69          20           0         475           2
          70          20           0         575           2
          71          20           0         675           2
          72          20           0         775           2
          73          20           0         875           2
          74          20           0         975           2
          75          20           0        1075           2
          76          20           0        1175           2
          77          20           0        1275           2
          78          20           0        1375           2
          79          20           0        1475           2
          80          20           0        1575           2
          81          20           0        1625           2
          82          40           0           0           2
          83          40           0          50           2
          84          40           0         100           2
          85          40           0         150           2
          86          40           0         200           2
          87          40           0         250           2
          88          40           0         300           2
          89          40           0         350           2
          90          40           0         400           2
          91          40           0         450           2
          92          40           0         500           2
          93          40           0         550           2
          94          40           0         600           2
          95          40           0         650           2
          96          40           0         700           2
          97          40           0         750           2
          98          40           0         800           2
          99          40           0         850           2
         100          40           0         900           2
         101          40           0         950           2
         102          40           0        1000           2
         103          40           0        1050           2
         104          40           0        1100           2
         105          40           0        1150           2
         106          40           0        1200           2
         107          40           0        1250           2
         108          40           0        1300           2
         109          40           0        1350           2
         110          40           0        1400           2
         111          40           0        1450           2
         112          40           0        1500           2
         113          40           0        1550           2
         114          40           0        1600           2
         115          20           0        1675           2
         116          40           0        1650           2
         117          40           0        1700           2
         118          20           0        1775           2
         119          40           0        1750           2
         120          40           0        1800           2
         121          20           0        1875           2
         122          40           0        1850           2
         123          40           0        1900           2
         124          20           0        1975           2
         125          40           0        1950           2
         126          40           0        2000           2
         127          20           0        2075           2
         128          36           0        2050           2
         129         504           0        2050           1
         130         520           0        2075           1
         131         500           0        2000           1
         132         500           0        1950           1
         133         520           0        1975           1
         134         500           0        1900           1
         135         500           0        1850           1
         136         520           0        1875           1
         137         500           0        1800           1
         138         500           0        1750           1
         139         520           0        1775           1
         140         500           0        1700           1
         141         500           0        1650           1
         142         520           0        1675           1
         143         500           0        1600           1
         144         500           0        1550           1
         145         500           0        1500           1
         146         500           0        1450           1
         147         500           0        1400           1
         148         500           0        1350           1
         149         500           0        1300           1
         150         500           0        1250           1
         151         500           0        1200           1
         152         500           0        1150           1
         153         500           0        1100           1
         154         500           0        1050           1
         155         500           0        1000           1
         156         500           0         950           1
         157         500           0         900           1
         158         500           0         850           1
         159         500           0         800           1
         160         500           0         750           1
         161         500           0         700           1
         162         500           0         650           1
         163         500           0         600           1
         164         500           0         550           1
         165         500           0         500           1
         166         500           0         450           1
         167         500           0         400           1
         168         500           0         350           1
         169         500           0         300           1
         170         500           0         250           1
         171         500           0         200           1
         172         500           0         150           1
         173         500           0         100           1
         174         500           0          50           1
         175         500           0           0           1
         176         520           0        1625           1
         177         520           0        1575           1
         178         520           0        1475           1
         179         520           0        1375           1
         180         520           0        1275           1
         181         520           0        1175           1
         182         520           0        1075           1
         183         520           0         975           1
         184         520           0         875           1
         185         520           0         775           1
         186         520           0         675           1
         187         520           0         575           1
         188         520           0         475           1
         189         520           0         375           1
         190         520           0         275           1
         191         520           0         175           1
         192         520           0          75           1
         193         536           0        2050           1
         194         520           0        2125           1
         195         520           0        2100           1
         196         540           0        2000           1
         197         520           0        2025           1
         198         540           0        1950           1
         199         540           0        1900           1
         200         520           0        1925           1
         201         540           0        1850           1
         202         540           0        1800           1
         203         520           0        1825           1
         204         540           0        1750           1
         205         540           0        1700           1
         206         520           0        1725           1
         207         540           0        1650           1
         208         540           0        1600           1
         209         540           0        1550           1
         210         540           0        1500           1
         211         540           0        1450           1
         212         540           0        1400           1
         213         540           0        1350           1
         214         540           0        1300           1
         215         540           0        1250           1
         216         540           0        1200           1
         217         540           0        1150           1
         218         540           0        1100           1
         219         540           0        1050           1
         220         540           0        1000           1
         221         540           0         950           1
         222         540           0         900           1
         223         540           0         850           1
         224         540           0         800           1
         225         540           0         750           1
         226         540           0         700           1
         227         540           0         650           1
         228         540           0         600           1
         229         540           0         550           1
         230         540           0         500           1
         231         540           0         450           1
         232         540           0         400           1
         233         540           0         350           1
         234         540           0         300           1
         235         540           0         250           1
         236         540           0         200           1
         237         540           0         150           1
         238         540           0         100           1
         239         540           0          50           1
         240         540           0           0           1
         241         520           0        1525           1
         242         520           0        1425           1
         243         520           0        1325           1
         244         520           0        1225           1
         245         520           0        1125           1
         246         520           0        1025           1
         247         520           0         925           1
         248         520           0         825           1
         249         520           0         725           1
         250         520           0         625           1
         251         520           0         525           1
         252         520           0         425           1
         253         520           0         325           1
         254         520           0         225           1
         255         520           0         125           1
         256         520           0          25           1

];


tipelectrode=58;    %nearest tip-electrode vertical distance in microns.

connector_position='bottom';

find_probewiring



s=[];
s.channels=probewiring(:,1);
s.x=probewiring(:,2);   %the reference electrode is always the top right channel when the probes are pointing up.
s.y=probewiring(:,3);
s.z=probewiring(:,4); s.z=s.z-min(s.z);
s.shaft=probewiring(:,5);
s.tipelectrode=tipelectrode;

if strcmp(headstage_source,'Intan')
    s.channels=s.channels-1;
end

%To plot the labeled channels:
figure(2)
clf
plot(s.x,s.z,'sqr', 'MarkerSize',11)
hold on
for i=1:size(probewiring,1)
text(s.x(i)-5,s.z(i),num2str(s.channels(i)),'FontSize',9)
end
axis([min(s.x)-50 max(s.x)+50 min(s.z)-50 max(s.z)+50])
axis equal
set(gca,'FontSize',10,'TickDir','out')
